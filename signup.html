<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register</title>
    <link rel="icon" href="adduser.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
        margin: 0;
        padding: 0;
        height: 100vh;
        font-family: 'Poppins', sans-serif;
        background: linear-gradient(135deg, #6e8efb, #a777e3);
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .container {
        background-color: #fff;
        border-radius: 20px;
        overflow: hidden;
        position: relative;
        width: 800px;
        height: 500px;
        transition: 0.5s ease-in-out;
        display: flex;
    }

    .panel {
        position: absolute;
        width: 30%;
        height: 100%;
        transition: 0.5s ease-in-out;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 40px;
    }

    .signin-container {
        left: 0;
        z-index:2;
        background: linear-gradient(135deg, #7b6cfb, #5f55f7);
        color: white;
    }

    .signup-container {
        width: 50%;
        right: 0;
        z-index: 1;
    }

    .container.left-panel-active .signin-container {
        transform: translateX(150%);
        z-index: 2;
    }

    .container.left-panel-active .signup-container {
        transform: translateX(-68%);
        z-index: 1;
    }

    h1 {
        margin-bottom: 0px;
        font-size: 28px;
    }

    p {
        font-size: 14px;
        text-align: center;
        margin-bottom: 20px;
    }

    a{
        text-decoration: none;
        color: #5f55f7;
    }

    a:hover{
        text-decoration: underline;
    }
    input[type="text"],
    input[type="email"],
    input[type="password"] {
        width: 100%;
        max-width: 280px;
        padding: 12px 15px;
        border: 1px solid #ccc;
        border-radius: 8px;
        background-color: #f5f5f5;
        font-size: 14px;
    }

    span{
        width: 100%;
        max-width: 280px;
        font-size: 12px;
        color: rgb(243, 34, 34);
    }

    input[type="button"] {
        margin-bottom: 60px;
        padding: 13px 35px;
        border: none;
        border-radius: 30px;
        font-weight: 600;
        cursor: pointer;
        transition: 0.3s;
    }

    .signin-container input[type="button"] {
        background-color: white;
        color: #5f55f7;
    }

    .signup-container input[type="button"] {
        background-color: #6e8efb;
        color: white;
    }

    .signin-container input[type="button"]:hover {
        background-color: #e8e8ff;
    }

    .social-btn {
        display: flex;
        gap: 15px;
        margin-bottom: 10px;
        margin-top: 20px;
    }

    .social-btn button {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 1px solid lightgray;
        background-color: white;
        color: #555;
        font-size: 16px;
        transition: 0.3s;
        cursor: pointer;
    }

    .social-btn button:hover {
        background-color: #e0e0e0;
    }
    .fade-out {
        opacity: 0;
        transition: 0.2s ease-in;
    }
    
    .shake{
        animation: shake 0.4s ease;
    }
    @keyframes shake {
        0%{
            transform: translateX(0px);
        }
        25%{
            transform: translateX(-5px);
        }
        50%{
            transform: translateX(5px);
        }
        75%{
            transform: translateX(-5px);
        }
        100%{
            transform: translateX(0px);
        }
    }

    </style>
</head>
<body>
    <div class="container" id="container">
        <div class="panel signin-container">
            <h1>Welcome Back!</h1>
            <p>To keep connected with us please login with your personal info</p>
            <input type="button" id="signinbtn" value="SIGN IN">
        </div>
        <div class="panel signup-container">
            <h1>Create Account</h1>
            <div class="social-btn"> 
                <button><i class="fab fa-facebook-f"></i></button>
                <button><i class="fab fa-google-plus-g"></i></button>
                <button><i class="fab fa-linkedin-in"></i></button>
            </div>
            <p>or use your email for registration</p>
            <input type="text" name="name" id="name" placeholder="Name">
            <span id="namespan"></span>
            <br>
            <input type="email" name="email" id="email" placeholder="Email">
            <span id="emailspan"></span>
            <br>
            <input type="password" name="password" id="mdp" placeholder="Password">
            <span id="passspan"></span>
            <br>
            <input type="button" id="signupbtn" value="SIGN UP">
        </div>
    </div>

    <script>
        const container=document.getElementById("container");
        const signupbtn=document.getElementById("signupbtn");
        const signinbtn=document.getElementById("signinbtn");

        signinbtn.addEventListener('click', () => {
            container.classList.add('left-panel-active');
            setTimeout(() => {
                document.body.classList.add("fade-out");
                setTimeout(() => {
                    window.location.href = "login.html";
                }, 100);
            }, 300); // Small delay before fade starts
        });

        const name=document.getElementById('name');
        const email=document.getElementById('email');
        const password=document.getElementById('mdp');

        function alpha(ch){
            let i=0;
            while(i<ch.length && ch[i].match(/[a-zA-Z]/)){
                i++;
            }
            if(i!=ch.length){
                document.getElementById('namespan').textContent="name incorrect";
            }
            return i===ch.length;
        }

        function check1(ch1){
            let i=0;
            let j=0;
            let num=0;
            while(i<ch1.length){
                if([".","-","_"].includes(ch1[i])){
                    j++;
                }
                else if(ch1[i].match(/[0-9]/)){
                    num++;
                }
                else if(ch1[i].match(/[a-zA-Z0-9]/)===null){
                    return false;
                }
                i++
            }
            return (j===0 || j===1) && num<4;
        }
        
        function check2(ch2){
            let i=0;
            while(i<ch2.length){
                if(/[a-z]/.test(ch2[i])===false){
                    return false;
                }
                i++
            }
            return true;
        }

        function mail(ch){
            ch1=ch.substring(0,ch.indexOf('@'));
            ch=ch.substring(ch.indexOf('@'));

            ch2=ch.substring(ch.indexOf('@')+1,ch.indexOf('.'));

            ch3=ch.substring(ch.indexOf('.')+1);

            if(!ch1 || !ch2 || ch2=="@" || !ch3){
                document.getElementById('emailspan').textContent='email incorrect';
            }
            else if(ch1[0].match(/[a-zA-Z]/)===null || ch1.length>20 || !check1(ch1)){
                document.getElementById('emailspan').textContent='the part before @ incorrect';
            }
            else if(ch2.length>10 || !check2(ch2)){
                document.getElementById('emailspan').textContent='the part between @ and . incorrect';
            }
            else if(ch3.length>3 || !check2(ch3)){
                document.getElementById('emailspan').textContent='the part after . incorrect';
            }
            else{
                document.getElementById('emailspan').textContent='';
                return true;
            }
            
        }

        function checkpass(pass){
            if(pass.length<8 || pass.length>20){
                document.getElementById('passspan').textContent='password length incorrect';
                return false;
            }
            let special=0;
            let letter=0;
            let upperletter=0;
            let num=0;
            for(let i=0 ; i<pass.length ; i++){
                if(pass[i].match(/[!@#$%^&*_-]/)){
                    special++;
                }
                else if(pass[i].match(/[a-z]/)){
                    letter++;
                }
                else if(pass[i].match(/[A-Z]/)){
                    upperletter++;
                }
                else if(pass[i].match(/[0-9]/)){
                    num++;
                }
                else{
                    document.getElementById('passspan').textContent='password incorrect';
                    return false;
                }
            }
            if(special!=1){
                document.getElementById('passspan').textContent='password should have a special character';
            }
            else if(letter<=4){
                document.getElementById('passspan').textContent='password should have a letter characters';
            }
            else if(upperletter<1){
                document.getElementById('passspan').textContent='password should have a uppercase letter characters';
            }
            else if(num<1){
                document.getElementById('passspan').textContent='password should have numbers';
            }
            else{
                document.getElementById('passspan').textContent='';
            }
            return (special===1 && letter>4 && upperletter>=1 && num>=1); 
        }

        signupbtn.addEventListener('click', ()=>{
            document.getElementById('namespan').textContent="";
            if(name.value==="" || !alpha(name.value.trim())){
                name.classList.add('shake');
                setTimeout(()=>{
                name.classList.remove('shake');
                },400);
                name.style.borderColor="red";
            }
            else{
                name.style.borderColor="green";
            }

            if(email.value==="" || !mail(email.value.trim())){
                email.classList.add('shake');
                setTimeout(() =>{
                    email.classList.remove('shake');
                },400);
                email.style.borderColor='red';
            }
            else{
                email.style.borderColor='green';
            }

            if(password.value==="" || !checkpass(password.value.trim())){
                password.classList.add('shake');
                setTimeout(() =>{
                    password.classList.remove('shake');
                },400);
                password.style.borderColor='red';
            }
            else{
                password.style.borderColor='green';
            }
            console.log(name.value, email.value, password.value);
            if(name.value!=="" && email.value!=="" && password.value!=="" && alpha(name.value.trim()) && mail(email.value.trim()) && checkpass(password.value.trim())){
                fetch("signup.php",{
                    method:"POST",
                    headers:{
                        "Content-Type":"application/x-www-form-urlencoded",
                    },
                    body: `name=${encodeURIComponent(name.value.trim())}&email=${encodeURIComponent(email.value.trim())}&password=${encodeURIComponent(password.value.trim())}`

                })
                .then(res => res.text())
                .then(data => {
                    console.log("php response:",data);
                    if(data==="User added successfully!"){
                        window.location.href='todo.php';
                    }
                    else if(data==="email already exist"){
                        email.classList.add('shake');
                        setTimeout(() =>{
                            email.classList.remove('shake');
                        },400);
                        email.style.borderColor='red';
                        document.getElementById('emailspan').textContent="email already exist";
                    }
                })
                 .catch(err => {
                    console.error("Network error:", err);
                    alert("Network error. Please try again.");
                });
               
            }
        });

    </script>
</body>
</html>